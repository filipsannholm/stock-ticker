FROM node:18-alpine

ARG SERVER_PORT=5000
ENV SERVER_PORT=${SERVER_PORT}

ARG REDIS_HOST=172.29.224.1
ENV REDIS_HOST=${REDIS_HOST}

ARG REDIS_PORT=6379
ENV REDIS_PORT=${REDIS_PORT}

WORKDIR /usr/src/app

COPY package*.json ./

RUN npm ci

COPY . .

EXPOSE $SERVER_PORT
CMD ["npm", "start"]